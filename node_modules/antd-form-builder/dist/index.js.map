{"version":3,"file":"index.js","sources":["../src/QuestionIcon.js","../src/FormBuilderField.js","../node_modules/style-inject/dist/style-inject.es.js","../src/FormBuilder.js","../src/defineAntdWidgets.js","../src/index.js"],"sourcesContent":["/* eslint react/self-closing-comp: 0 */\nimport React from 'react'\n\nexport default () => (\n  <svg viewBox=\"0 0 1024 1024\" className=\"antd-form-builder-question-icon\">\n    <path d=\"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64z m0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372z\"></path>\n    <path d=\"M623.6 316.7C593.6 290.4 554 276 512 276s-81.6 14.5-111.6 40.7C369.2 344 352 380.7 352 420v7.6c0 4.4 3.6 8 8 8h48c4.4 0 8-3.6 8-8V420c0-44.1 43.1-80 96-80s96 35.9 96 80c0 31.1-22 59.6-56.1 72.7-21.2 8.1-39.2 22.3-52.1 40.9-13.1 19-19.9 41.8-19.9 64.9V620c0 4.4 3.6 8 8 8h48c4.4 0 8-3.6 8-8v-22.7c0-19.7 12.4-37.7 30.9-44.8 59-22.7 97.1-74.7 97.1-132.5 0.1-39.3-17.1-76-48.3-103.3z\"></path>\n    <path d=\"M512 732m-40 0a40 40 0 1 0 80 0 40 40 0 1 0-80 0Z\"></path>\n  </svg>\n)\n","/* eslint react/prop-types: 0 */\nimport React, { forwardRef } from 'react'\nimport memoize from 'lodash/memoize'\nimport isArray from 'lodash/isArray'\nimport has from 'lodash/has'\nimport find from 'lodash/find'\nimport pick from 'lodash/pick'\nimport capitalize from 'lodash/capitalize'\nimport { Form, Tooltip, Input } from 'antd'\nimport QuestionIcon from './QuestionIcon'\nconst FormItem = Form.Item\n\nconst isV4 = !!Form.useForm\n\nconst getValue = (obj, namePath) => {\n  const arr = typeof namePath === 'string' ? namePath.split('.') : namePath\n  let current = obj\n\n  for (let i = 0; i < arr.length; i += 1) {\n    if (has(current, arr[i])) {\n      current = current[arr[i]]\n    } else {\n      return undefined\n    }\n  }\n\n  return current\n}\n\nconst getWrappedComponentWithForwardRef = memoize(Comp =>\n  forwardRef((props, ref) => {\n    return (\n      <span ref={ref}>\n        <Comp {...props} />\n      </span>\n    )\n  }),\n)\n\nfunction FormBuilderField(props) {\n  const { field, meta, form } = props\n\n  const label = field.tooltip ? (\n    <span>\n      {field.label}\n      <Tooltip title={field.tooltip}>\n        {' '}\n        <QuestionIcon />\n      </Tooltip>\n    </span>\n  ) : (\n    field.label\n  )\n\n  let formItemLayout =\n    field.formItemLayout || (field.label ? getValue(meta, 'formItemLayout') || [8, 16] : null)\n  if (isArray(formItemLayout) && formItemLayout.length >= 2) {\n    formItemLayout = {\n      labelCol: { span: formItemLayout[0] },\n      wrapperCol: { span: formItemLayout[1] },\n    }\n  }\n  const isFieldViewMode = meta.viewMode || field.viewMode || field.readOnly\n  const formItemProps = {\n    key: field.key,\n    colon: meta.colon,\n    ...(meta.formItemLayout !== null ? formItemLayout : {}),\n    label,\n    ...pick(field, [\n      'help',\n      'extra',\n      'labelCol',\n      'wrapperCol',\n      'colon',\n      'htmlFor',\n      'noStyle',\n      'validateStatus',\n      'hasFeedback',\n    ]),\n\n    ...field.formItemProps,\n    className: `${\n      meta.viewMode ? 'ant-form-item-view-mode' + (isV4 ? ' ant-form-item-view-mode-v4' : '') : ''\n    } ${field.className || (field.formItemProps && field.formItemProps.className)}`,\n  }\n  if (isV4) {\n    if (field.key || field.name) {\n      formItemProps.name = field.name || field.key.split('.')\n    }\n    Object.assign(formItemProps, {\n      noStyle: field.noFormItem || field.noStyle,\n      ...pick(field, ['shouldUpdate', 'dependencies']),\n    })\n  }\n\n  if (field.label && typeof field.label === 'string') {\n    formItemProps['data-label'] = field.label // help e2e test\n  }\n  if (field.colSpan && formItemProps.labelCol && !field.formItemLayout) {\n    const labelCol = Math.round(formItemProps.labelCol.span / field.colSpan)\n    Object.assign(formItemProps, {\n      labelCol: { span: labelCol },\n      wrapperCol: { span: 24 - labelCol },\n    })\n  }\n\n  if (field.render) {\n    return field.render.call(this, {\n      formItemProps,\n      field,\n      form,\n      ...pick(props, ['disabled', 'viewMode', 'initialValues']),\n    })\n  }\n\n  let initialValue\n  const initialValues = meta.initialValues || {}\n  if (has(field, 'initialValue')) {\n    initialValue = field.initialValue\n  } else if (field.getInitialValue) {\n    initialValue = field.getInitialValue(field, initialValues, form)\n  } else {\n    initialValue = getValue(initialValues, field.name || field.key)\n  }\n\n  // Handle field props\n  const rules = [...(field.rules || [])]\n  if (field.required) {\n    rules.unshift({ required: true, message: field.message || field.requiredMessage || undefined })\n  }\n  const fieldProps = {\n    initialValue,\n    preserve: meta.preserve,\n    ...pick(field, [\n      'getValueFromEvent',\n      'getValueProps',\n      'normalize',\n      'trigger',\n      'preserve',\n      'valuePropName',\n      'validateTrigger',\n      'validateFirst',\n    ]),\n    rules,\n    ...field.fieldProps,\n  }\n  if (isV4) {\n    Object.assign(formItemProps, fieldProps)\n  }\n\n  if (isFieldViewMode) {\n    let viewEle = null\n    const formValues = form ? (isV4 ? form.getFieldsValue(true) : form.getFieldsValue()) : {}\n    let viewValue = has(formValues, field.key || field.name.join('.'))\n      ? getValue(formValues, formItemProps.name || field.key)\n      : initialValue\n    if (field.renderView) {\n      viewEle = field.renderView(viewValue, form, initialValues)\n    } else if (field.viewWidget) {\n      const ViewWidget = field.viewWidget\n      viewEle = (\n        <ViewWidget value={viewValue} form={form} field={field} {...field.viewWidgetProps} />\n      )\n    } else if (field.link) {\n      const href = typeof field.link === 'string' ? field.link : viewValue\n      viewEle = (\n        <a href={href} target={field.linkTarget || '_self'}>\n          {viewValue}\n        </a>\n      )\n    } else if (field.options) {\n      // a little hacky here, if a field is select/options like, auto use label for value\n      const found = find(field.options, opt => opt[0] === viewValue)\n      if (found) {\n        viewValue = found[1]\n      }\n    }\n    if (!viewEle) {\n      if (typeof viewValue === 'boolean') viewEle = capitalize(String(viewValue))\n      else if (viewValue === undefined) viewEle = 'N/A'\n      else {\n        viewEle = (\n          <span className=\"antd-form-builder-string-content\">{String(viewValue) || ''}</span>\n        )\n      }\n    }\n\n    // TODO: readOnly seems to be the same with viewMode in antd v4\n    if (form && field.readOnly) {\n      const ele = <span className=\"antd-form-builder-read-only-content\">{viewEle}</span>\n      return (\n        <FormItem {...formItemProps}>\n          {isV4 ? ele : form.getFieldDecorator(field.id || field.key, fieldProps)(ele)}\n        </FormItem>\n      )\n    }\n    delete formItemProps.name\n    delete formItemProps.key\n    return <FormItem {...formItemProps}>{viewEle}</FormItem>\n  }\n\n  // Handle widget props\n  const wp = field.widgetProps || {}\n  const widgetProps = {\n    ...pick(field, ['placeholder', 'type', 'className', 'class', 'onChange']),\n    disabled: field.disabled || meta.disabled || props.disabled,\n    ...wp,\n  }\n\n  let FieldWidget = field.widget || Input\n\n  if (field.forwardRef) {\n    FieldWidget = getWrappedComponentWithForwardRef(FieldWidget)\n  }\n  const valueProps = {}\n  const ele = (\n    <FieldWidget {...widgetProps} {...valueProps}>\n      {field.children || null}\n    </FieldWidget>\n  )\n  const ele2 = isV4 ? ele : form.getFieldDecorator(field.id || field.key, fieldProps)(ele)\n\n  if (isV4) {\n    // antd v4 always has form item\n    return <FormItem {...formItemProps}>{ele}</FormItem>\n  }\n  return field.noFormItem || field.noStyle ? ele2 : <FormItem {...formItemProps}>{ele2}</FormItem>\n}\n\nexport default FormBuilderField\n","function styleInject(css, ref) {\n  if ( ref === void 0 ) ref = {};\n  var insertAt = ref.insertAt;\n\n  if (!css || typeof document === 'undefined') { return; }\n\n  var head = document.head || document.getElementsByTagName('head')[0];\n  var style = document.createElement('style');\n  style.type = 'text/css';\n\n  if (insertAt === 'top') {\n    if (head.firstChild) {\n      head.insertBefore(style, head.firstChild);\n    } else {\n      head.appendChild(style);\n    }\n  } else {\n    head.appendChild(style);\n  }\n\n  if (style.styleSheet) {\n    style.styleSheet.cssText = css;\n  } else {\n    style.appendChild(document.createTextNode(css));\n  }\n}\n\nexport default styleInject;\n","/* eslint react/no-multi-comp: 0 */\nimport React from 'react'\nimport PropTypes from 'prop-types'\nimport isArray from 'lodash/isArray'\nimport castArray from 'lodash/castArray'\nimport find from 'lodash/find'\nimport has from 'lodash/has'\nimport { Col, Row, Form } from 'antd'\nimport FormBuilderField from './FormBuilderField'\nimport './FormBuilder.css'\n\nconst isV4 = !!Form.useForm\n\nconst widgetMap = {}\n\nfunction getWidget(widget) {\n  if (!widget) return null\n  if (typeof widget === 'string') {\n    if (!widgetMap[widget] || !widgetMap[widget].widget) {\n      throw new Error(\n        `Widget '${widget}' not found, did you defined it by FormBuilder.defineComponent?`,\n      )\n    }\n    return widgetMap[widget].widget\n  }\n  return widget\n}\n\nfunction normalizeMeta(meta) {\n  let fields = isArray(meta) ? meta : meta.fields || meta.elements\n  if (!fields) fields = [meta]\n  fields = fields.map(field => {\n    const widget = getWidget(field.widget)\n    const viewWidget = getWidget(field.viewWidget)\n    const dynamic = field.dynamic !== false\n    // Find metaConvertor\n    const item = find(\n      Object.values(widgetMap),\n      entry => (entry.widget === widget || entry.widget === viewWidget) && entry.metaConvertor,\n    )\n    if (item) {\n      const newField = item.metaConvertor(field)\n      if (!newField) {\n        throw new Error(`metaConvertor of '${String(field.widget)}' must return a field`)\n      }\n      return { ...newField, viewWidget, widget, dynamic }\n    }\n    return { ...field, widget, viewWidget, dynamic }\n  })\n  if (isArray(meta) || (!meta.fields && !meta.elements)) {\n    return { fields }\n  }\n  return {\n    ...meta,\n    fields,\n  }\n}\n\nfunction FormBuilder(props) {\n  const { getMeta, form } = props\n  const meta = getMeta ? getMeta(form, props) : props.meta\n  return <FormBuilderInner {...props} form={form ? form.current || form : null} meta={meta} />\n  // return (\n  //   <Form.Item shouldUpdate noStyle>\n  //     {() => {\n  //       return <FormBuilderInner {...props} form={form ? form.current || form : null} meta={meta} />\n  //     }}\n  //   </Form.Item>\n  // )\n}\n\nfunction FormBuilderInner(props) {\n  const { meta, viewMode, initialValues, disabled = false, form = null } = props\n  if (!meta) return null\n\n  const newMeta = normalizeMeta(meta)\n  newMeta.viewMode = newMeta.viewMode || viewMode\n  newMeta.initialValues = newMeta.initialValues || initialValues\n  const { fields, columns = 1, gutter = 10 } = newMeta\n  const elements = fields.map(field => (\n    <FormBuilderField\n      key={field.key}\n      field={field}\n      disabled={disabled}\n      meta={newMeta}\n      form={form}\n    />\n  ))\n  if (columns === 1) {\n    return elements\n  }\n\n  const rows = []\n  // for each column , how many grid cols\n  const spanUnit = 24 / columns\n  // eslint-disable-next-line\n  for (let i = 0; i < elements.length; ) {\n    const cols = []\n    for (\n      let j = 0;\n      (j < columns || j === 0) && // total col span is less than columns\n      i < elements.length && // element exist\n      (!['left', 'both'].includes(fields[i].clear) || j === 0); // field doesn't need to start a new row\n\n    ) {\n      const fieldSpan = fields[i].colSpan || 1\n      cols.push(\n        <Col key={j} span={Math.min(24, spanUnit * fieldSpan)}>\n          {elements[i]}\n        </Col>,\n      )\n      j += fieldSpan\n      if (['both', 'right'].includes(fields[i].clear)) {\n        i += 1\n        break\n      }\n      i += 1\n    }\n    rows.push(\n      <Row key={i} gutter={gutter}>\n        {cols}\n      </Row>,\n    )\n  }\n  return rows\n}\n\nFormBuilder.defineWidget = (name, widget, metaConvertor = null) => {\n  if (widgetMap[name]) throw new Error(`Widget \"${name}\" already defined.`)\n  widgetMap[name] = {\n    widget,\n    metaConvertor,\n  }\n}\n\nFormBuilder.useForceUpdate = () => {\n  const [, updateState] = React.useState()\n  const forceUpdate = React.useCallback(() => updateState({}), [])\n  return forceUpdate\n}\n\nFormBuilder.useForm = f => {\n  throw new Error('FormBuilder.useForm is removed. Please use Form.useForm().')\n}\n\nFormBuilder.createForm = ctx => {\n  throw new Error(\n    'FormBuilder.createForm is removed. Please use Form.useForm for functional component and ref for class component.',\n  )\n}\nFormBuilder.propTypes = {\n  meta: PropTypes.any,\n}\n\nexport default FormBuilder\n","import React from 'react'\nimport FormBuilder from './FormBuilder'\nimport { Input, Checkbox, Switch, Button, Select, InputNumber, Radio, DatePicker } from 'antd'\nimport _ from 'lodash'\n\nconst mapOptions = options => {\n  if (!_.isArray(options)) {\n    throw new Error('Options should be array in form builder meta.')\n  }\n  return options.map(opt => {\n    if (_.isArray(opt)) {\n      return { value: opt[0], label: opt[1] }\n    } else if (_.isPlainObject(opt)) {\n      return opt\n    } else {\n      return { value: opt, label: opt }\n    }\n  })\n}\n\nFormBuilder.defineWidget('checkbox', Checkbox, field => {\n  return { ...field, valuePropName: 'checked' }\n})\n\nFormBuilder.defineWidget('switch', Switch, field => {\n  return { ...field, valuePropName: 'checked' }\n})\n\nFormBuilder.defineWidget('button', Button)\nFormBuilder.defineWidget('input', Input)\nFormBuilder.defineWidget('password', Input.Password)\nFormBuilder.defineWidget('textarea', Input.TextArea)\nFormBuilder.defineWidget('number', InputNumber)\nFormBuilder.defineWidget('date-picker', DatePicker)\nFormBuilder.defineWidget('radio', Radio)\nFormBuilder.defineWidget('radio-group', Radio.Group, field => {\n  const RadioComp = field.buttonGroup ? Radio.Button : Radio\n  if (field.options && !field.children) {\n    return {\n      ...field,\n      widgetProps: {\n        ...field.widgetProps,\n        name: field.key,\n      },\n      children: mapOptions(field.options).map(opt => (\n        <RadioComp value={opt.value} key={opt.value}>\n          {opt.label}\n        </RadioComp>\n      )),\n    }\n  }\n  return field\n})\n\nFormBuilder.defineWidget('checkbox-group', Checkbox.Group, field => {\n  if (field.options && !field.children) {\n    return {\n      ...field,\n      children: mapOptions(field.options).map(opt => (\n        <Checkbox value={opt.value} key={opt.value}>\n          {opt.label}\n        </Checkbox>\n      )),\n    }\n  }\n  return field\n})\nFormBuilder.defineWidget('select', Select, field => {\n  if (field.options && !field.children) {\n    return {\n      ...field,\n      children: mapOptions(field.options).map(opt => (\n        <Select.Option label={opt.label} value={opt.value} key={opt.value} disabled={opt.disabled}>\n          {opt.children || opt.label}\n        </Select.Option>\n      )),\n    }\n  }\n  return field\n})\n","import FormBuilder from './FormBuilder'\nimport './defineAntdWidgets'\nexport default FormBuilder\n// export default FormBuilder from './FormBuilder'\n"],"names":["React","FormItem","Form","Item","isV4","useForm","getValue","obj","namePath","arr","split","current","i","length","has","undefined","getWrappedComponentWithForwardRef","memoize","forwardRef","props","ref","FormBuilderField","field","meta","form","label","tooltip","formItemLayout","isArray","span","isFieldViewMode","viewMode","readOnly","formItemProps","key","colon","pick","className","name","assign","noFormItem","noStyle","colSpan","labelCol","Math","round","render","call","initialValue","initialValues","getInitialValue","rules","required","unshift","message","requiredMessage","fieldProps","preserve","viewEle","formValues","getFieldsValue","viewValue","join","renderView","viewWidget","ViewWidget","viewWidgetProps","link","href","linkTarget","options","found","find","opt","capitalize","String","ele","getFieldDecorator","id","wp","widgetProps","disabled","FieldWidget","widget","Input","valueProps","children","ele2","widgetMap","getWidget","Error","normalizeMeta","fields","elements","map","dynamic","item","Object","values","entry","metaConvertor","newField","FormBuilder","getMeta","FormBuilderInner","newMeta","columns","gutter","rows","spanUnit","cols","j","includes","clear","fieldSpan","push","min","defineWidget","useForceUpdate","useState","updateState","forceUpdate","useCallback","createForm","propTypes","PropTypes","any","mapOptions","_","value","isPlainObject","Checkbox","valuePropName","Switch","Button","Password","TextArea","InputNumber","DatePicker","Radio","Group","RadioComp","buttonGroup","Select"],"mappings":"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"}